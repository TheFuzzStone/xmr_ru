---
title: "Отчёт mj за апрель-май по разработке и интеграциям"
date: "2022-05-10"
categories:
  - "Новости"
tags:
  - "CCS"
lead: "Ежемесячный отчёт mj в ключе работы над его CCS предложением."
pager: true
toc: false
sidebar: "right"
widgets:
  - "recent"
  - "taglist"
---

_Уважаемое сообщество!_

Я задержал свой отчёт по моему [предложению в CCS](https://ccs.getmonero.org/proposals/mj-part-time-2022-q2.html) на полмесяца, поскольку в первой половине апреля в моей квартире поломался водопровод. К счастью, квартира уже выставлена на продажу. В то же самое время при наличии свободного времени я работал над стратегией сбережения энергии батареи моего лэптопа. В конечном счёте мне удалось выработать стратегию, позволяющую работать вне офиса (что я и делал в течение последних 2 недель), а также потратить большую часть времени, отведённого на исследования, равно как и кода, для работы над проектом SolOptXMR.

Тем не менее, поскольку это время на подготовку нельзя напрямую отнести к моей работе над Monero в соответствии с предложением, опубликованным в CCS, я решил ничего не брать за то, что было сделано в первой половине апреля, за задержанный отчёт, но буду ожидать оплаты с равноценной задержкой, то есть после первой половины мая, а затем после первой половины июня, когда и должен будет поступить платёж.

## _Краткое описание работы в апреле-мае_

Наконец-то у нас появились новые разработчики! Добро пожаловать! Как вы понимаете, для обучения рабочей культуре требуется некоторое время, как это было в моём случае, когда The Old Cr3w терпеливо направлял меня в нужное русло и тратил на меня своё время.

И вот теперь пришло моё время сделать нечто подобное. Поэтому в первую очередь я решил проверить все PR новых разработчиков и разъяснить некоторые нюансы. Был один «особый» несчастливый PR, на который мной и другими рецензентами было потрачено пару часов из-за общего непонимания, насколько быстро, как правило, ломаются некоторые вещи :) Если кратко: я предложил разбить очень большой PR на множество маленьких PR, которые можно было бы рецензировать и объединять независимо друг от друга, то есть не накапливая их в одном большом PR,  поскольку из-за возможного конфликта при включении создаётся риск, что ни одна из частей включена не будет — либо всё, либо ничего. Как только я высказал своё предложение и моя идея была отклонена, произошло именно то, что я предсказывал... трижды! Вы можете [ознакомиться с этим PR](https://github.com/monero-project/monero/pull/8211), если хотите. В конечном счёте он всё же прошёл.

Вот полный список проверенных мной PR.

_Всё ещё открытые_:
- https://github.com/monero-project/monero/pull/8226
- https://github.com/monero-project/monero/pull/8281
- https://github.com/monero-project/monero/pull/8300
- https://github.com/monero-project/monero/pull/8301

_Объединены или закрыты_:
- https://github.com/monero-project/monero/pull/8297
- https://github.com/monero-project/monero/pull/8273
- https://github.com/monero-project/monero/pull/8247
- https://github.com/monero-project/monero/pull/8246
- https://github.com/monero-project/monero/pull/8241
- https://github.com/monero-project/monero/pull/8240
- https://github.com/monero-project/monero/pull/8239
- https://github.com/monero-project/monero/pull/8232
- https://github.com/monero-project/monero/pull/8228
- https://github.com/monero-project/monero/pull/8211

selsta попросил меня отрецензировать определённые PR, связанные с GUI. selsta известны мои навыки, благодаря которым мы смогли довольно быстро продвинуть самые важные вещи. Конечно же, это не означает, что мы таким вот образом «похлопываем друг друга по спине». Скорее, мы проверяем работу друг друга именно так, как это должны делать настоящие рецензенты. Опять же, мне нравится этим заниматься, а вы получаете ощутимый результат.

_Ниже приводится полный список PR, связанных с GUI_:
- https://github.com/monero-project/monero-gui/pull/3871
- https://github.com/monero-project/monero-gui/pull/3875
- https://github.com/monero-project/monero-gui/pull/3879
- https://github.com/monero-project/monero-gui/pull/3887
- https://github.com/monero-project/monero-gui/pull/3888
- https://github.com/monero-project/monero-gui/pull/3889
- https://github.com/monero-project/monero-gui/pull/3890
- https://github.com/monero-project/monero-gui/pull/3894

Я также принял участие в верификации последней версии. Всякий раз, когда я занимаюсь этим, в процессе верификации находится что-то, требующее исправления. И этот раз не был исключением. Мною было предложено решение против неактуальных файлов, которое после проверки u/hyc стало более простым и менее навязчивым. Эти два решения в целом подтверждают принцип наименьшего удивления с точки зрения пользователя. В данном случае, если я даю команду настройки среды, то мне нужно, чтобы в ней отсутствовали неактуальные файлы, которые в противном случае блокировали бы процесс сборки. При этом мне не приходится удалять всю директорию вручную.

## _Большие решаемые задачи_

_Monero Core – тестирование libwallet_

И снова selsta попросил меня взяться за решение этой большой задачи по исправлению уже устаревших тестов [libwallet_api_tests](https://github.com/monero-project/monero/tree/master/tests/libwallet_api_tests). После того как я присмотрелся повнимательнее, оказалось, что даже сценарии подготовки этих тестов уже устарели. Я ознакомился с документацией [внешнего проекта](https://github.com/moneroexamples/private-testnet) и обнаружил, что имеется ещё один момент, возможно, требующий исправления: демон без конца блокировал тест, как если бы это была вредоносная программа. Поэтому тест нельзя было провести надлежащим образом.

Несмотря на то, что сценарии уже опубликованы (но не включены), задача исправления самих тестов (на C++) находится в стадии реализации.

- Тесты: сценарии исправления libwallet_api_tests: https://github.com/monero-project/monero/pull/8264.
- Связанные материалы: обновлённая документация внешнего проекта (собственность moneroexamples), касающаяся использования тестовой сети Monero: https://github.com/moneroexamples/private-testnet/pull/9.

## _Исследовательская лаборатория Monero_

_Алгоритм выбора ложных выходов_

Rucknium, J-Bermann и я разбираем алгоритм выбора ложных выходов, чтобы лучше понять, как он работает, путём проведения статистических тестов. Для этого нам необходим альтернативный вариант реализации. В качестве языка нами был выбран Python, обеспечивающий целое разнообразие концепций и широко используемый исследователями. Мой подход [задокументирован здесь](https://github.com/mj-xmr/monero-mrl-mj/tree/decoy/decoy).

_Моделирование повышения комиссий_

Я взялся за моделирование динамики между повышением комиссии за проведение транзакций и увеличением размера блокчейна. Я получил от AticMine и Endor очень ценную информацию, которая полностью подготовила меня к процессу моделирования. Однако из-за наличия двух других задач, требующих решения (тестирование libwallet и алгоритм выбора ложных выходов), в настоящий момент я немного перегружен и сначала хотел бы закончить решение по крайней мере одной из задач перед тем, как взяться за эту.

## _Заключение_

Я благодарен всем братьям и анонимам за финансирование моего предложения, несмотря на ранее невиданные попытки саботажа. Я рад, что нас так много и вместе мы являемся решающей силой, а также что так много согласных со мной людей и что мы в состоянии оставить всяческие детские игры в песочнице.

## _Минимальные ветви_

Мною также были открыты минимальные ветви, о которых я упомяну здесь совсем кратко:
- Обновление авторского права в файлах хардфорка до 2022 года: https://github.com/monero-project/monero/pull/8302.
- CMake: добавление отсутствующих заголовков с помощью макроса monero_find_all_headers: https://github.com/monero-project/monero/pull/8207.
- Документация: минимизация зависимостей boost_dep в файле README.md:  https://github.com/monero-project/monero-gui/pull/3851.
- Небольшие изменения: добавление .vscode/ в .gitignore: https://github.com/monero-project/monero/pull/8260. Это небольшая и полезная вещь, которая пригодится при использовании VSCodium в Monero.
- Cmake: добавление отсутствующей опции BUILD_SHARED_LIBS: https://github.com/monero-project/monero/pull/8235. То же, что и выше. Необходимо для использования VSCodium в целях, указанных под ссылкой.

Как можно понять, три последних PR связаны с подготовкой документации VSCodium, которую я собираюсь написать, как только будут выполнены все предварительные условия.

## _Долгое время компиляции (ВАЖНО!)_
Я позволю себе немного пошуметь. Повторная реализация алгоритма выбора ложных выходов является требующей значительных временных ресурсов задачей. И здесь я немного запаздываю из-за того времени, что уходит на компиляцию класса wallet2 или файла заголовка, который является чем угодно, кроме интерфейсного файла. Это, скорее, исходный блоб, содержащий более 2400 строк. Я уже давно пытался решить эту проблему, понимая, что рано или поздно она коснётся меня (равно как и остальных). Поэтому я проактивно открыл [этот PR](https://github.com/monero-project/monero/pull/7679), но, как обычно, он не был принят, поскольку это изменение ускорит работу для всех, но оно «не решает никаких реальных проблем». В конечном счёте PR устарел, и мне понадобилось примерно столько же времени, чтобы вернуть его к жизни. [u/aFungible](https://www.reddit.com/u/aFungible/) опубликовал великолепную статью, в которой описан этот феномен нерешительности/промедления с работой с более широкой перспективы:

https://www.reddit.com/r/Monero/comments/ssinb2/monero_vs_bitcoin_source_code_analyses_how/

Как вам известно, я поддерживаю отчёт о состоянии Monero (Monero Health Report), который можно найти по следующей ссылке: http://cryptog.hopto.org/monero/health/. Именно там можно узнать, как увеличивается (= сокращается) время компиляции при наличии [множества слияний](http://cryptog.hopto.org/monero/health/img/cbta.png):

![01](/img/post/2022-05-10-mjs-dev-report-for-march-2022-23/01.png)  
_Время компиляции в секундах: самые левые точки являются самыми последними._

Посетив эту веб-страницу, вы увидите, что wallet2 «лидирует» не только [в подробной статистике по времени компиляции](http://cryptog.hopto.org/monero/health/data/67e5ca9ad/67e5ca9ad-cba-result.txt), но и по потребляемому [объёму памяти](http://cryptog.hopto.org/monero/health/data/67e5ca9ad/67e5ca9ad-mem-usage-prod.txt), оставляя позади [относительный размер заголовка](http://cryptog.hopto.org/monero/health/data/67e5ca9ad/67e5ca9ad-headers-result.txt). Теперь я понимаю, что чистка менее важна, чем вопросы приватности и прочие приоритетные вещи, но, видите ли, в данном случае я не смогу достаточно быстро повысить уровень приватности, поскольку я просто застреваю во всём остальном и не могу выбраться, так как мне не дают провести чистку, даже несмотря на то, что я знаю, как это сделать. Я пытаюсь убедить других разработчиков проверить мой код, но они просто не будут заниматься этим. И я не могу сделать ничего лучше, чем попросить вас, спонсоров, набраться немного терпения.

## _SolOptXMR_

Должен отметить, что вялая реакция на проблему с wallet2 довольно серьёзно сказалась на моём ментальном состоянии. Благодаря работе над чем-то, что строится и работает так же быстро, как мой собственный проект,  [SolOptXMR](https://github.com/mj-xmr/SolOptXMR), я ещё не выгорел как разработчик Monero.

И здесь у меня наконец-то хорошие новости: мы приближаемся к состоянию «минимально жизнеспособного продукта». Чтобы пост не получился слишком длинным, я опубликую отдельный пост, как только состояние будет достигнуто. А сейчас я просто отмечу, что вы, вероятно, уже получали подсказки от нашей системы, когда включить/выключить какую машину для майнинга и произвести моделирование батареи. И всё это сопровождается прогнозом погоды на 7 дней вперёд. Ниже приводится пример работы программы решения, способной находить привязанное по времени решение для майнинга, исключающее перенапряжение батареи, а также (что более важно) недостаточное напряжение:

![02](/img/post/2022-05-10-mjs-dev-report-for-march-2022-23/02.png)  
_Моделирование нагрузки на батарею на 6 дней вперёд_

Простое руководство можно скачать [по этой ссылке](https://github.com/mj-xmr/SolOptXMR#quickstart).

##_Заключение_

Я публикую этот отчёт с опережением на 4 дня, поскольку в моей работе едва ли что-то изменится в значительной мере. Теперь я хочу сосредоточиться на решении самых сложных и долгосрочных задач, которые уже поставлены, и у меня достаточно амбиций, чтобы справиться с ними до конца следующего месяца, когда истечёт срок данного предложения в CCS. Спасибо за прочтение!

mj

---

_Источник: [mj's dev report Apr.-May 2022 (2/3)](https://www.reddit.com/r/Monero/comments/umgew1/mjs_dev_report_aprmay_2022_23/)_

_Перевод: [Mr. Pickles](https://t.me/v1docq47)_  
_Коррекция: [Kukima](https://t.me/Kukima)_
