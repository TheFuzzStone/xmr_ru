---
title: "CT-012: Правдоподобное отрицание при сокрытии тома с помощью VeraCrypt в Tails"
date: "2023-01-30"
categories:
  - "Статьи"
  - "Cypherpunk Transmission"
tags:
  - "Cypherpunk Transmission"
thumbnail: "img/copyright/cypherpunk-transmission/ct-012.png"
lead: "Это двенадцатый отчёт из новой серии 'Cypherpunk Transmission'"
pager: true
toc: true
sidebar: "right"
---

## _Мотивация_

Инструмент для шифрования томов под названием VeraCrypt (VC) обеспечивает правдоподобное отрицание путём сокрытия тома и применения скрытых операционных систем.

Настоящее руководство расскажет о том, как скрыть том, воспользовавшись консолью VeraCrypt и зашифрованными файлами-контейнерами в Tails.

Предполагается, что пользователь будет придерживаться всех необходимых мер предосторожности, в результате чего злоумышленник не сможет доказать наличие скрытого тома внутри файла.

## _Предварительные условия_

- Наличие ОЗУ объёмом более 2 Гб.
- Наличие одного USB-накопителя с установленной системой Tails.
- Базовый опыт работы с консолью.
- Наличие интернет-соединения.
- 30-60 минут свободного времени.

## 1. _Конфигурирование Tails_

### 1.1 _Настройка пароля администратора_

Перезапустите машину при подключённом USB-накопителе с системой Tails.

В подсказке _Welcome to Tails_, нажмите **+** внизу экрана, после чего появится панель дополнительных настроек _Additional Settings_. Задайте пароль, нажав **ON** в разделе _Administration Password_. Запустите систему, выбрав _Start Tails_.

### 1.2 _Создание раздела exFat (опционально)_

Данная партиция пригодится для переноса зашифрованного с помощью VC тома между Tails и другими операционными системами.

Если вам нужна данная функция, сделайте всё до того, как создавать постоянное хранилище, которое займёт всё дисковое пространства вашего устройства.

Перейдите в следующий раздел: _Applications_ > _Utilities_ > _Disks_.

Выберите USB-накопитель, нажмите _Free Space_ и **+**.

Убедитесь, что у вас осталось свободное место для постоянного хранилища и нажмите _Next_, а затем перейдите в _Volume Name_ > _Other_ > _Next_ > _exFAT_ > _Create_, после чего введите свой пароль администратора, созданный при выполнении шага 1.1.

### 1.3 _Создание зашифрованного постоянного хранилища_

Мы можем позволить Tails использовать всё свободное пространство, оставшееся на USB-накопителе, чтобы создать партицию зашифрованного постоянного хранилища.

Переходим в раздел _Applications_ > _Favorites_ > _Persistent Storage_.

Выбираем фразу-пароль, которая будет использоваться для расшифровки постоянного хранилища (5-7 случайных слов).

Нажимаем _Create_ и проверяем, чтобы параметры _Persistent Folder_ и _Additional Software_ были активны. Закрываем окно, нажав в верхнем правом углу **x**.

### 1.4 _Настройка сетевого соединения_

Если окно настройки сетевого соединения не появилось в процессе выполнения предыдущих шагов, мы можем вручную подключить Wi-Fi/Ethernet с помощью простого визарда в разделе _Applications_ > _Tor Connection_. Выбираем автоматическое подключение _Connect to tor automatically_ > и нажимаем _Connect to tor_.

В результате должно появиться подтверждение успешного подключения _Connected to tor successfully_.

_Примечание: если вы захотите использовать мост (см. [CT-009](https://xmr.ru/copyright/cypherpunk-transmission/ct-009/)), конфигурируйте в процессе реализации этого шага_.

## 2. _Установка VeraCrypt в постоянное хранилище_

### 2.1 _Скачивание консоли VC_

Прежде всего, следует проверить версию консоли VC для пакета Debian/Ubuntu:

```
torsocks curl https://launchpad.net/veracrypt/trunk/ | grep 'Latest version is'
```

_Примечание: если команда не сработает, посетите страницу veracrypt.fr для скачивания файлов_.

Вы должны увидеть что-то подобное: _Latest version is 1.25.9_.

Рассмотрим версию в качестве внешней переменной:

```
VERACRYPT_RELEASE=1.25.9
```

Примечание: замените указанный номер на номер фактической последней версии.

Скачайте в постоянную папку пакет _.deb_ и соответствующий файл подписи PGP:

```
cd ~/Persistent/ && torsocks wget https://launchpad.net/veracrypt/trunk/$VERACRYPT_RELEASE/+download/veracrypt-console-$VERACRYPT_RELEASE-Debian-11-amd64.deb && torsocks wget https://launchpad.net/veracrypt/trunk/$VERACRYPT_RELEASE/+download/veracrypt-console-$VERACRYPT_RELEASE-Debian-11-amd64.deb.sig
```

### 2.2 _Проверка скачанного пакета_

Извлеките публичный PGP ключ VC:

```
torsocks wget https://www.idrix.fr/Veracrypt/Veracrypt_PGP_public_key.asc
```

Просмотрите идентификационную метку ключа перед тем, как импортировать его:

```
gpg --show-keys --with-fingerprint Veracrypt_PGP_public_key.asc
```

Должно отобразиться следующее:

```
Key fingerpring = 5069 A233 D55A 0EEB 174A 5FC3 821A CD02 680D 16DE
```

Теперь просмотрите идентификационную метку с официального веб-сайта:

```
torsocks curl https://www.veracrypt.fr/en/Downloads.html | grep 'Fingerprint='
```

Только в том случае, если две идентификационные метки совпадают, импортируйте ключ:

```
gpg --import Veracrypt_PGP_public_key.asc
```

Должно отобразиться подтверждение успешного импорта ключа: _imported: 1_.

Примечание: если какая-либо из команд не сработает, откройте браузер Tor и скачайте файлы вручную.

Затем нам требуется подтвердить версию:

```
gpg --verify veracrypt-console-$VERACRYPT_RELEASE-Debian-11-amd64.deb.sig
```

Если вы не получите правильной подписи, остановите процесс и повторите всё, начиная с шага 2.

### 2.3 _Установка консоли VeraCrypt_

```
sudo dpkg -i veracrypt-console-$VERACRYPT_RELEASE-Debian-11-amd64.deb
```

Версию можно проверить с помощью следующей команды:

```
veracrypt --version
```

_Примечание: в Tails пакеты .deb нельзя установить в постоянном режиме. Следует скачать двоичный файл veracrypt в постоянную папку /usr/bin/, если вы хотите иметь возможность воспользоваться им позднее и не хотите запускать dpkg после каждой перезагрузки (то есть, вам необходимо скопировать его с помощью команды `cp /usr/bin/veracrypt ~/Persistent` и запустить, воспользовавшись `./veracrypt`)_.


## 3. _Создание стандартного внешнего тома с помощью VeraCrypt_

_Примечание: в команде, указанной ниже, замените [OUTER_CONTAINER_PASSWORD] паролем от вашего внешнего тома, а также [VOLUME_PATH] на путь к вашему файлу-контейнеру (имя файла и расширение могут быть любыми)_.

```
veracrypt -t -c -k '' --pim=0 --encryption=aes --hash=sha-512 --random-source=/dev/urandom --volume-type=normal --filesystem=ext4 -p [OUTER_CONTAINER_PASSWORD] --size=500M [VOLUME_PATH]
```

Если/когда система запросит пароль администратора Tails, введите его.

В папке ~/Persistent должен появиться новый Файл с именем [OUTER_VOLUME_PATH]. Это будет внешний зашифрованный том, содержащий внутренний скрытый том.

## 4. _Создание скрытого внутреннего тома VeraCrypt_

_Примечание: замените [INNER_CONTAINER_PASSWORD] паролем от вашего внутреннего тома, а также [VOLUME_PATH] на путь к вашему внешнему файлу-контейнеру (так же, как ри выполнении предыдущего шага)_.

```
veracrypt -t -c -k '' --pim=0 --encryption=aes --hash=sha-512 --random-source=/dev/urandom --volume-type=hidden --filesystem=ext4 -p [INNER_CONTAINER_PASSWORD] --size=100M [VOLUME_PATH]
```

Вы можете изменить размер томов, задав другое значение флагу `--size=`.

## 5. _Подключение и отключение томов_

### 5.1 _Метод с применением консоли VC_

#### 5.1.1 _Подключение только внешнего тома_

```
veracrypt --mount [VOLUME_PATH] [VOLUME_MOUNT_LOCATION] --password [OUTER_CONTAINER_PASSWORD] --pim=0 -k '' --protect-hidden=no
```

_Примечание: Замените [VOLUME_PATH] на путь к зашифрованному файлу VC, [VOLUME_MOUNT_LOCATION] — на директорию для подключения (то есть, /media/veracrypt1), и [OUTER_CONTAINER_PASSWORD] — паролем от внешнего тома. Если вы воспользуйтесь командой `protect-hidden=yes`, у вас также запросят пароль от внутреннего контейнера_.

#### 5.1.2 _Подключение скрытого внутреннего тома_

```
veracrypt --mount [VOLUME_PATH] [VOLUME_MOUNT_LOCATION] --password [INNER_CONTAINER_PASSWORD] --pim=0 -k '' --protect-hidden=no
```

_Примечание: замените [INNER_CONTAINER_PASSWORD] паролем от скрытого внутреннего тома. Если у вас возникнут проблемы, попробуйте воспользоваться командой `veracrypt --mount` без дополнительных параметров и следуйте подсказкам_.

#### 5.1.3 _Отключение томов VC_

Пожалуй, наиболее удобный способ будет заключаться в отключении всех подключённых томов VC:

```
veracrypt --dismount
```

Используйте `veracrypt --help` для получения полного списка команд.

### 5.2 _Метод с применением VC GUI в Tails_

Тома VeraCrypt также можно разблокировать с помощью встроенной в Tails утилиты _Unlock VeraCrypt Volumes_.

Доступ к ней можно получить, перейдя в раздел _Applications_ > _Utilities_ > _Add_ >. Затем следует выбрать зашифрованный файл-контейнер VC и, перед тем как нажать _Unlock_, ввести пароль от внешнего тома.

Чтобы разблокировать срытый том, следует выбрать соответствующее окошко и ввести пароль от скрытого тома.

Вот и всё.

## _Примечания_

- При выборе наиболее подходящего из указанных в данном руководстве инструмента, следует учитывать вашу модель угрозы (см. [CT-001](https://xmr.ru/copyright/cypherpunk-transmission/ct-001/)).
- Необходимо обеспечить резервные копии ваших зашифрованных контейнеров VC.
- Ваши тома VC должны быть защищены сложными паролями/фразами-паролями (см. [CT-010](https://xmr.ru/copyright/cypherpunk-transmission/ct-010/)).
- Как вариант, вы можете использовать файлы ключей или персональный множитель итераций PIM, которые обеспечат дополнительную защиту ваших зашифрованных контейнеров VC.
- Вместо шифровки томов в файлах VC также может использоваться для создания томов в партициях / на устройствах.
- Если у вас возникнут проблемы с версией консоли VC, вы можете скачать установщик Linux с официального веб-сайта.
- Чтобы получить доступ к контейнерам VC в других операционных системах, следует скопировать файлы в партицию exfat, созданную при выполнении шага 1.2.
- Подсказки по обеспечению правдоподобного отрицания: заполните внешний том ложными файлами (при этом следует соблюдать осторожность, чтобы не переписать скрытый том); если вам придётся разблокировать зашифрованный том VC, введите путь к внешнему тому вместо скрытого.
- Более подробно изучите VeraCrypt: общайтесь на форумах, узнайте, как можно взломать VC, изучайте вопросы, связанные с безопасностью скрытых томов.

Теперь вы в состоянии повысить уровень правдоподобного отрицания путём создания скрытых томов внутри зашифрованных файлов-контейнеров VeraCrypt.

---

## _Обратная связь_

Если эта статья показалась вам полезной, заинтересовала вас, дайте мне знать, и я сделаю всё возможное, чтобы публиковать подобные отчёты [Cypherpunk Transmission](https://monero.observer/tag/CT/) каждый (второй?) понедельник.

Вопросы, правки и предложения приветствуются.

Благодарю gnuteardrops из [monero.graphics](https://monero.graphics/) за потрясающую графику xkcd. Работа и шрифт xkcd лицензированы в соответствии с [CC BY-NC 3.0](https://github.com/ipython/xkcd-font/blob/master/LICENSE).

---

_Источник: [CT-012: Plausible deniability with VeraCrypt hidden volumes in Tails](https://monero.observer/cypherpunk-transmission-012-plausible-deniability-veracrypt-hidden-volumes-tails/)_

_Перевод: [Mr. Pickles](https://t.me/v1docq47)_  
_Коррекция: [Kukima](https://t.me/Kukima)_
