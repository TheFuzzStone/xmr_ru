---
title: "«Страх» - научно-фантастический рассказ в стиле Monero"
date: "2021-05-13"
categories:
  - "Статьи"
tags:
  - "Научно-фантастический рассказ"
lead: "Среди трейдеров с Уолл-стрит они были известны как «два Дейва», поскольку оба носили имя Дейв. Они сидели в баре и отмечали свою очередную победу на фондовом рынке, которая принесла им чуть менее десяти миллионов долларов США."
pager: true
toc: false
sidebar: "right"
---

**Ведущий**: Приветствую всех на юбилейном выпуске подкаста, посвящённом «15-летию Monero». Сегодня у нас в гостях давний участник сообщества Monero, он пропустил только первые три года из пятнадцати, а значит, ему есть, что рассказать нам. Приветствуем rbrunner7!

**rbrunner7**: Спасибо, рад встрече.

**Ведущий**: В чём причина твоего долгого сотрудничества с Monero? Что тебя заинтересовало больше всего?

**rbrunner7**: Практически с самого начала меня впечатлили определённые психологические аспекты криптовалюты. В принципе, как и большинство базовых вещей, связанных с ней, то, что именно обеспечивает её ценность. Я даже писал фантастические рассказы об этом!

**Ведущий**: И сегодня ты нам расскажешь об эпизоде в истории Monero, в котором ты принял самое непосредственное участие, эпизоде, наиболее интересном с психологической точки зрения, так?

**rbrunner7**: Да. Сегодня почти любой, даже минимально интересующийся криптовалютами, знает, что Monero позволяет полностью скрыть суммы, переводимые в транзакциях, что на самом деле хорошо и что отличает и даёт monero преимущество в сравнении со многими другими монетами. Но именно эта особенность практически неизбежно возбуждает в людях определённый страх. И этот страх однажды стал своего рода уязвимостью, которой воспользовались для проведения атаки.

---​

Среди трейдеров с Уолл-стрит они были известны как «два Дейва», поскольку оба носили имя Дейв. Они сидели в баре и отмечали свою очередную победу на фондовом рынке, которая принесла им чуть менее десяти миллионов долларов США. Они играли на понижающемся курсе акций с помощью опционов и коротких продаж. Многие компании, попавшие им в прицел, теряли вдвое в цене, и другие трейдеры в шутку говорили в таких случаях, что эти компании были «атакованы двойным Дейвом».

Даже удивительно то количество компаний, чьи грязные секреты всплыли наружу, напугав участников фондовой биржи и значительно уронив цену акций всего через несколько дней после того, как Дейвы открывали большие позиции. Также удивительно, как некоторые из них пытались бороться с убедительно звучащими слухами, которые в равной степени влияли на падение цены их акций, когда Дейвы практически всякий раз играли на снижении цены или имели хорошую выгоду на опционах ещё до того, как компаниям удавалось хоть как-то опровергнуть слухи. Тем не менее никому ни разу не удалось поймать их за руку...

«Нам нужно опробовать что-то другое для разнообразия. Игра на коротких позициях уже поднадоела. Кроме того, сегодня уже можно без труда напугать акционеров, чтобы они в панике стали сбывать свои акции», — сказал Дейв 1.

«И какую альтернативу ты предлагаешь?» — спросил Дейв 2.

«Криптовалюты. Конечно же, не Bitcoin, он слишком велик для нас. Нужно что-то поменьше, но всё же ценное и достаточно ликвидное, какой-нибудь из больших альткоинов».

«Интересно. Уже есть что-то на примете?»

«Да, есть, — подтвердил Дейв 1. — Монета называется Monero. Я выбрал её, поскольку программисты и пользователи возомнили себе, что они выше других, после недавнего успеха, сопутствовавшего их монете. И мне очень хотелось бы увидеть, как они упадут с этой высоты. Кроме того, конечно же, я уже нашёл нечто, чем мы сможем воздействовать на них психологически».

«Понятно, ты уже почуял запах крови! И чего же они боятся больше всего?» — поинтересовался Дейв 2.

«Это так называемый инфляционный баг. Вдруг кто-нибудь найдёт способ создать миллионы монет из воздуха, воспользовавшись лазейкой в используемом ими математическом решении или ошибкой в программном обеспечении. И, скажу я тебе, эти опасения не беспочвенны. Monero, как они утверждают сами, является анонимной монетой — никто не может видеть, кто кому платит и сколько. Всё скрыто просто идеально. И как тут быть уверенными в том, что никто и никогда не воспользуется этим для обмана?»

Дейв 2 немного обдумал сказанное и изрёк: «Звучит хорошо, и, пожалуй, мы сможем поработать над этим. Но как можно понизить стоимость криптовалюты?»

«Пожалуй, можно. На некоторых биржах. Но я не уверен, будут ли они ликвидны в достаточной мере для этого. Может, лучше было бы просто запугать владельцев и сбить цену, потом объявить слухи безосновательными, подождать, пока цена не отскочит обратно — вот тебе и выгода!»

«Всё, как я люблю! — засмеялся Дейв. — Итак, сколько мы готовы инвестировать в проект?»

«Хм. Думаю, что цена упадёт гораздо ниже, если мы станем также активно манипулировать ею на самых крупных биржах. Это, возможно, будет затратно, но в конечном счёте и прибыль будет больше. В данном случае лично я бы вложил всё, что мы заработали на нашем последнем предприятии».

«Все 10 миллионов? Чёрт возьми, а почему бы и нет?!»

Дейв 1 кивнул: «Договорились. Я уже выделил первые 50 000 долларов, чтобы нанять одного блестящего, но не очень оплачиваемого и недооценённого криптографа. Он напишет для нас убедительную научную статью о серьёзных недостатках Monero».

«А есть такие недостатки?»

Дейв 1 улыбнулся: «А ты как думаешь?»

---​

Вы когда-нибудь задумывались над тем, что позволяет идеально, с одной стороны, скрыть суммы, переводимые в транзакциях Monero, от всех остальных пользователей, кроме законного получателя, и, с другой стороны, даёт возможность внешним наблюдателям точно верифицировать, что при этом не было создано ни одной монеты просто «из воздуха»?

Транзакция Monero состоит из 1 или нескольких «входов», позволяющих потратить XMR, а также 1 или нескольких «выходов», которые необходимы, чтобы отправить эти XMR на какие-то адреса (входы, конечно же, это не что иное, как выходы более ранних транзакций).

Чтобы всё работало правильно, сумма входов и сумма выходов всегда должны быть равными. Или, выражаясь более «математически», сумма входов минус сумма выходов должна равняться нулю, тогда не теряется и, что более важно, не создаётся новых монет.

Есть второе, гораздо менее очевидное условие, которое должно соблюдаться: запрещено использование «отрицательных» выходов. В противном случае вы могли бы, например, имея некоторое количество входов на сумму 1 XMR, построить для себя транзакцию с 2 выходами: один на плюс 100 000 XMR, а второй на минус 99 999 XMR. Сумма верна, но поскольку вы можете просто проигнорировать отрицательный выход, и то у вас внезапно появится 100 000 XMR, которые можно будет потратить!

Для доказательства соответствия сумм входов и выходов Monero использует математическую конструкцию, называемую «обязательством Педерсена», а для доказательства отсутствия отрицательных выходов в транзакции — вторую конструкцию, называемую Bulletproof.

Обе конструкции используют подход под названием «доказательство с нулевым разглашением» или ZKP для краткости. Обязательства Педерсена и Bulletproofs служат для доказательства данных, связанных с суммами транзакций Monero, но не раскрывают точных сумм в XMR. Вы как «верификатор» будете знать, что количество входов минус количество выходов будет равно 0 и что отрицательные значения отсутствуют, но при этом вы не узнаете ничего другого.

Нам, простым людям, далёким от криптографии, в это трудно поверить, может быть, это даже похоже на неразрешимый парадокс, но, что интересно, существует ряд реальных примеров, демонстрирующих подход в простой для понимания ситуации, которые могут повысить уверенность в том, что сложная математическая магия, защищающая Monero, действительно работает.

Вот мой любимый пример ZKP из реальной жизни.

В 1987 году британский иллюстратор Мартин Хэндфорд опубликовал детскую книгу-головоломку «Где Уолли?», которая в Северной Америке была издана под названием «Где Вальдо?». Задача состояла в том, чтобы найти персонажа по имени Уолли, одетого в красно-белую полосатую рубашку, шляпу и очки. Уолли находился где-то на больших иллюстрациях с десятками других людей, занимающихся разными забавными вещами. Большое количество деталей, включая такие вещи, как банные полотенца в красно-белую полоску, которые сбивали с толку, делали поиск Уолли сложным и интересным.

Теперь, допустим, я хочу доказать вам, что нашёл Уолли на определенной картинке, но не раскрывая вам точное местоположение Уолли на этой картинке. Видите сходство с ZKP? Я доказываю вам, что знаю что-то, не давая вам возможности узнать это что-то, и вы не получаете никакой дополнительной информации.

Звучит, как нечто невозможное? Что ж, тогда рассмотрим ситуацию более детально:

Я подготавливаю большой кусок картона с отверстием посередине, достаточно большим, чтобы показать изображение Уолли на имеющейся у меня картинке. Я кладу картон на картинку соответствующим образом, пока вы не смотрите, а затем прошу вас убедиться, что Уолли действительно виден через отверстие.

Последняя деталь, необходимая, чтобы всё прошло идеально: картон должен быть достаточно большим и полностью закрывать изображение, чтобы нельзя было угадать местонахождение Уолли, глядя на по-прежнему видимые части изображения.

Я убираю картон, и, если вы не видите, как я это делаю, в конце вы не будете знать ничего, кроме того факта, что я действительно нашёл Уолли.

---​

_Официальное заявление Исследовательской лаборатории Monero (MRL) относительно «Статьи»_

_Около двух недель назад на сервере препринтов была опубликована статья под названием «Подделка доказательств диапазона с нулевым разглашением без решения задачи дискретного логарифмирования на эллиптической кривой», которую сообщество Monero между собой называет просто «статьёй». Она привлекла значительное внимание из-за своей очевидной значимости для криптовалюты Monero, поскольку именно такое доказательство лежит в основе протокола и обеспечивает защиту от проведения транзакций, позволяющих создать XMR «из воздуха» при помощи отрицательных выходов._

_Поскольку статья вызвала большую озабоченность и породила множество слухов, мы хотели бы проинформировать всех о текущей позиции MRL в отношении данного документа и того, как мы намерены действовать в связи с возникшей проблемой._

_Мы подтверждаем, что автор уже довольно давно и успешно работает в области криптологии и ранее опубликовал ряд достойных уважения работ. Поэтому мы очень серьезно относимся к тому, что происходит._

_Однако проведение анализа оказалось сложной задачей. Автор использует новую арифметику, которую трудно понять из-за её непростой и новаторской природы. Мы пока не можем судить, верно ли основное утверждение, согласно которому данная арифметика позволяет разрабатывать алгоритмы, которые могут быть использованы для эффективной подделки доказательств диапазона и «взлома» Monero, соответственно._

_Поэтому, к сожалению, ещё слишком рано говорить о том, насколько эта статья актуальна для Monero и потребуется ли изменение протокола в будущем. Мы посвящаем анализу всё своё время и просим сообщество проявить терпение. Мы обязательно сообщим, как только появится какая-либо важная информация._

_Спасибо._

---​

Уже несколько лет, как на сайт социальной сети Reddit в общий доступ был выложен прекрасный инструмент: Monero Tips Bot. Он связывает кошельки Monero с именами пользователей Reddit и позволяет вам перевести несколько Monero любому пользователю, включив специальную команду в свой ответ на комментарий. Бот управляет кошельками от имени пользователей в фоновом режиме и таким образом технически позволяет украсть монеты. Но поскольку он предназначен для перевода лишь небольших сумм, вы, вероятно, не станете класть в свой кошелек больших сумм.

Поэтому люди были весьма удивлены, увидев перевод суммы, превышавшей тысячу долларов США в XMR. Она досталась автору поста, который, казалось бы, и не заслуживал никакого перевода, и, уж конечно, в таком большом размере, так как это была просто очередная версия часто задаваемого вопроса «Как проверить прирост денежной массы Monero?» с выражением опасений относительно того, что кто-то может найти способ создать миллионы XMR так, что никто об этом не узнает до тех пор, пока не станет слишком поздно.

Почти сразу люди начали размышлять над тем, что это вообще такое было? Кто-то потратил серьёзную сумму XMR просто для развлечения в ответ на выражение опасений, что кто-то где-то может быть уже занят созданием серьёзного количества XMR? Сложите картинку воедино! Кто-то определённо пытается нас обмануть!

Домыслы усилились, когда таинственный «жертвователь» вновь появился в истории публикуемых сообщений и каждый день стал переводить суммы того же размера, что и за предыдущие сообщения, посвящённые той же теме. Ограничение в одно пожертвование в день выглядело так, как будто было рассчитано на максимальный эффект, как в случае с китайской пыткой водой. Но через неделю или около того уже многие стали заметно нервничать.

---​

**Ведущий**: Полагаю, после публикации «статьи» и последующих уколов вроде пожертвований в размере 1000 долларов на Reddit всё постепенно приблизилось к точке кипения?

**rbrunner7**: Можно и так сказать. Цена XMR на биржах начала снижаться. Также были признаки того, что кто-то пытается систематически занизить цену и при этом несёт серьезные убытки. По мере того как всё это продолжалось, серьёзней становилась ситуация в целом.

**Ведущий**: Что-то нужно было делать.

**rbrunner7**: Определённо. К счастью, люди, стоявшие за всем этим, «два Дейва», при подготовке своих атак подробно расспросили разработчика Monero о технологии и сообществе и случайно проболтались о том, что намеревались сделать. Этот разработчик, в свою очередь, проинформировал об этом основную команду Monero и нас, других разработчиков, и в итоге у нас состоялась секретная онлайн-встреча, на которой мы обсудили возможные варианты решения проблемы, которые я до сих пор довольно хорошо помню.

**Ведущий**: Интересно. Расскажи поподробнее.

**rbrunner7**: Мы знали, что явные, прямые действия против двух Дейвов, например, с привлечением полиции, будут бесперспективными, учитывая, что у нас не было веских доказательств. Нам нужно было отбиваться самостоятельно, чтобы остановить их атаки, а в идеале также каким-то образом попытаться предотвратить получение ими прибыли.

**Ведущий**: Для этого вы решили реализовать довольно рискованную стратегию.

**rbrunner7**: Совершенно верно. Мы повернули против них их собственное оружие — страх.

---​

Помимо основной сети Monero, которая широко используется для совершения платежей, существует ещё одна гораздо меньшая специализированная сеть Monero, которая называется «тестовой сетью». Как следует из названия, она в основном используется программистами для тестирования новых функций Monero или нового программного обеспечения, взаимодействующего с сетью. Хотя монеты в тестовой сети и не стоят совершенно ничего, все правила, регулирующие транзакции Monero, применяются в ней так же строго, как и в «основной сети». В конце концов, если бы вы могли обойти их, тестирование не имело бы особого смысла.

Некоторые люди используют в тестовой сети так называемые «краны», веб-сайты, где вы можете ввести свой адрес Monero в тестовой сети в соответствующую форму и получить XMR. Это быстро решает проблему, которая заключается в том, что без монет ваши возможности, связанные с тестированием, конечно же, довольно ограничены.

Один из таких кранов пережил свои 15 минут славы, когда кто-то перевёл сайту XMR, после чего на нём появилось следующее сообщение: «В настоящее время у нас есть около 4 012 153 тестовых XMR для распространения».

На следующий день человек, запустивший кран, опубликовал об этом сообщение на Reddit и поделился «публичным ключом просмотра» кошелька крана, который технически позволил внешним наблюдателям проверить все входящие транзакции. Любой, достаточно хорошо разбирающийся в инструментах Monero, смог лично убедиться в этом: одна транзакция на сумму более 4 миллионов XMR.

Конечно, даже 4 миллиона тестовых XMR ничего не стоят. Но дело было не в этом. Суть заключалась в том, что это составляло почти четверть всех существующих в тестовой сети монет, которые были переведены за одну транзакцию. Было довольно трудно поверить, что один-единственный человек может легитимно контролировать такое огромное количество монет. Многие быстро поняли, что с этой транзакцией что-то не так: если кому-то из них после публикации «статьи» ещё требовалось дополнительное доказательство того, что небеса рухнули на Monero, то это было именно оно.

Это, конечно, никак не помогло, и в тот же день история Monero Tips Bot продолжила развиваться, но уже в большем масштабе. Теперь каждый из уже довольно многочисленных постов о возможной ошибке, связанной с инфляцией Monero, вознаграждался в невероятном размере, составлявшем 10 000 долларов США в XMR.

И как верхушка айсберга на Monero GitHub появился PR, предложение по изменению кода, опубликованное самым плодовитым и наиболее уважаемым разработчиком Monero moneromooo. Было неясно, в чём именно состояли изменения, но было несложно увидеть, какие части кода должны были быть затронуты: код критически важных доказательств диапазона, Bulletproofs. Вскоре после этого появился второй PR, который, казалось, был подготовкой к незапланированному экстренному хардфорку, переключению сети Monero на несколько иной протокол, который вынудил бы всех участников сети обновить своё программное обеспечение. Такие хардфорки не делаются без чертовски веской причины.

---​

**Ведущий**: Значит, эти события как бы сильно намекали на наличие ошибки, связанной с инфляцией, но это уже были не два Дейва, а само сообщество разработчиков Monero нанесло ответный удар?

**rbrunner7**: Да. Нам удалось устроить для них настоящее шоу. Конечно, это также напугало и многих других пользователей, но мы рискнули, расценив это как временный сопутствующий ущерб.

**Ведущий**: И это сработало.

**rbrunner7**: К счастью. Мы узнали от разработчика, контактировавшего с двумя Дейвами, что теперь они были убеждены в том, что узнали правду по чистой случайности, и поспешили избавиться от Monero. Мы получили также и косвенное подтверждение, потому что явные манипуляции с ценой на биржах прекратились.

**Ведущий**: Позже, когда вся история была раскрыта сообществу Monero и вера в монету постепенно восстановилась, было в подробностях рассказано, как удалось совершить все эти подвиги. Но для тех, кто «не в теме», можешь кратко рассказать ещё раз?

**rbrunner7**: Конечно. Чудовищные по своим размерам пожертвования на Reddit были фальшивыми, ведь никому не нужно тратить там свои XMR. Мы делали их в сотрудничестве с автором бота, который «подправил» его для нас. Предложенные изменения кода Bulletproof также были своего рода фальшивыми, хитрыми перекомпоновками кода без каких-либо реальных последствий, и включали в себя некоторые давно запланированные оптимизации, чтобы их фиктивность не была слишком очевидной. И уж точно никакого экстренного хардфорка не состоялось бы.

**Ведущий**: А что насчёт транзакции на 4 миллиона тестовых XMR? Должно быть, она была настоящей — этого уж никак не подделать.

**rbrunner7**: Да, и я горжусь этим, потому что сам это придумал. Я вспомнил, как Fluffypony однажды рассказывал в IRC, как он годами занимался майнингом в тестовой сети в одиночку и таким образом накопил огромное состояние в тестовых XMR. После того как мы привлекли его, всё стало лишь вопросом систематического объединения тысяч и тысяч выходов из вознаграждений за блоки, которыми он владел, в один действительно крупный. На это потребовались дни, но, к счастью, Дейвы оказались недостаточно сообразительными, чтобы заметить очень необычное количество транзакций, которые проводились в тестовой сети в это время!

**Ведущий**: Восхитительно. Прежде чем мы закончим эту очень интересную юбилейную серию, не хотелось бы сказать что-нибудь в заключении?

**rbrunner7**: Нападение двух Дейвов продемонстрировало важность серьёзного отношения к страхам людей. Для меня всегда было и остаётся важным обучение людей с целью укрепления их уверенности в передовой технологии обеспечения анонимности Monero. И да, даже написание забавных рассказов может немного помочь в этом!

**Ведущий**: Спасибо, что пришёл к нам.

**rbrunner7**: Было приятно.

---

_Источник: ["Proof of Distance" - A Monero Science Fiction Short Story](https://rbrunner7.github.io/proof_of_distance.html)_

_Перевод: [Mr. Pickles](https://t.me/v1docq47)_  
_Коррекция: [Kukima](https://t.me/Kukima)_
